{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Admin/Desktop/sty/diplom3/rideshare-frontend/src/app/bookings/page.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Card, List, Button, message, Tabs, Tag } from 'antd';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Booking, Trip } from '@/types/trip';\r\n\r\nconst { TabPane } = Tabs;\r\n\r\nconst BookingsPage: React.FC = () => {\r\n  const [bookings, setBookings] = useState<Booking[]>([]);\r\n  const [driverTrips, setDriverTrips] = useState<Trip[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    fetchBookings();\r\n    fetchDriverTrips();\r\n  }, []);\r\n\r\n  const fetchBookings = async () => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch('http://localhost:8000/api/bookings/', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setBookings(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      message.error('Failed to load bookings');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDriverTrips = async () => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch('http://localhost:8000/api/trips/driver_trips/', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setDriverTrips(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching driver trips:', error);\r\n    }\r\n  };\r\n\r\n  const handleAcceptBooking = async (bookingId: number) => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch(`http://localhost:8000/api/bookings/${bookingId}/accept/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.ok) {\r\n        message.success('Booking accepted successfully');\r\n        fetchBookings();\r\n        fetchDriverTrips();\r\n      } else {\r\n        const errorData = await response.json();\r\n        message.error(errorData.error || 'Failed to accept booking');\r\n      }\r\n    } catch (error) {\r\n      message.error('Failed to accept booking');\r\n    }\r\n  };\r\n\r\n  const handleRejectBooking = async (bookingId: number) => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch(`http://localhost:8000/api/bookings/${bookingId}/reject/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.ok) {\r\n        message.success('Booking rejected successfully');\r\n        fetchBookings();\r\n        fetchDriverTrips();\r\n      } else {\r\n        const errorData = await response.json();\r\n        message.error(errorData.error || 'Failed to reject booking');\r\n      }\r\n    } catch (error) {\r\n      message.error('Failed to reject booking');\r\n    }\r\n  };\r\n\r\n  const handleCancelBooking = async (bookingId: number) => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch(`http://localhost:8000/api/bookings/${bookingId}/cancel/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n      if (response.ok) {\r\n        message.success('Booking cancelled successfully');\r\n        fetchBookings();\r\n      } else {\r\n        const errorData = await response.json();\r\n        message.error(errorData.error || 'Failed to cancel booking');\r\n      }\r\n    } catch (error) {\r\n      message.error('Failed to cancel booking');\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return 'orange';\r\n      case 'confirmed':\r\n        return 'green';\r\n      case 'cancelled':\r\n        return 'red';\r\n      case 'completed':\r\n        return 'blue';\r\n      default:\r\n        return 'default';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">Bookings</h1>\r\n      <Tabs defaultActiveKey=\"1\">\r\n        <TabPane tab=\"My Bookings\" key=\"1\">\r\n          <List\r\n            loading={loading}\r\n            dataSource={bookings}\r\n            renderItem={(booking) => (\r\n              <List.Item>\r\n                <Card className=\"w-full\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <div>\r\n                      <h3 className=\"text-lg font-semibold\">\r\n                        Trip: {booking.trip.departure_location} → {booking.trip.destination_location}\r\n                      </h3>\r\n                      <p>Date: {new Date(booking.trip.date).toLocaleDateString()}</p>\r\n                      <p>Time: {booking.trip.time}</p>\r\n                      <p>Seats: {booking.seats_booked}</p>\r\n                      <p>Total Price: ${booking.total_price}</p>\r\n                      <Tag color={getStatusColor(booking.status)}>\r\n                        {booking.status.toUpperCase()}\r\n                      </Tag>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      {booking.status === 'pending' && (\r\n                        <Button danger onClick={() => handleCancelBooking(booking.id)}>\r\n                          Cancel\r\n                        </Button>\r\n                      )}\r\n                      <Button onClick={() => router.push(`/trips/${booking.trip.id}`)}>\r\n                        View Trip\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </List.Item>\r\n            )}\r\n          />\r\n        </TabPane>\r\n        <TabPane tab=\"Driver Bookings\" key=\"2\">\r\n          <List\r\n            loading={loading}\r\n            dataSource={driverTrips}\r\n            renderItem={(trip) => (\r\n              <List.Item>\r\n                <Card className=\"w-full\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <div>\r\n                      <h3 className=\"text-lg font-semibold\">\r\n                        Trip: {trip.departure_location} → {trip.destination_location}\r\n                      </h3>\r\n                      <p>Date: {new Date(trip.date).toLocaleDateString()}</p>\r\n                      <p>Time: {trip.time}</p>\r\n                      <p>Available Seats: {trip.available_seats}</p>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <Button onClick={() => router.push(`/trips/${trip.id}`)}>\r\n                        View Trip\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                  {trip.bookings && trip.bookings.length > 0 && (\r\n                    <div className=\"mt-4\">\r\n                      <h4 className=\"font-semibold mb-2\">Booking Requests:</h4>\r\n                      {trip.bookings.map((booking) => (\r\n                        <div key={booking.id} className=\"border-t pt-2 mt-2\">\r\n                          <p>Passenger: {booking.passenger.username}</p>\r\n                          <p>Seats: {booking.seats_booked}</p>\r\n                          <Tag color={getStatusColor(booking.status)}>\r\n                            {booking.status.toUpperCase()}\r\n                          </Tag>\r\n                          {booking.status === 'pending' && (\r\n                            <div className=\"flex gap-2 mt-2\">\r\n                              <Button type=\"primary\" onClick={() => handleAcceptBooking(booking.id)}>\r\n                                Accept\r\n                              </Button>\r\n                              <Button danger onClick={() => handleRejectBooking(booking.id)}>\r\n                                Reject\r\n                              </Button>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </Card>\r\n              </List.Item>\r\n            )}\r\n          />\r\n        </TabPane>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookingsPage; "],"names":[],"mappings":"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","debugId":null}}]
}