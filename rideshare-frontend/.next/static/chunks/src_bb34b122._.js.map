{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Admin/Desktop/sty/diplom3/rideshare-frontend/src/constants.ts"],"sourcesContent":["export const API_BASE_URL = 'http://localhost:8000'; "],"names":[],"mappings":";;;AAAO,MAAM,eAAe","debugId":null}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Admin/Desktop/sty/diplom3/rideshare-frontend/src/app/profile/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Image from 'next/image';\r\nimport { API_BASE_URL } from '@/constants';\r\n\r\ninterface User {\r\n  id: number;\r\n  username: string;\r\n  email: string;\r\n  phone_number: string;\r\n  is_verified: boolean;\r\n  first_name?: string;\r\n  last_name?: string;\r\n  bio?: string;\r\n  avatar?: string;\r\n  rating?: number;\r\n}\r\n\r\ninterface ApiError {\r\n  [key: string]: string[];\r\n}\r\n\r\nexport default function ProfilePage() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [formData, setFormData] = useState<Partial<User>>({});\r\n  const [formErrors, setFormErrors] = useState<ApiError>({});\r\n\r\n  useEffect(() => {\r\n    const checkAuth = () => {\r\n      const token = localStorage.getItem('access_token');\r\n      if (!token) {\r\n        router.push('/auth/login');\r\n        return;\r\n      }\r\n      fetchUserData();\r\n    };\r\n\r\n    checkAuth();\r\n  }, [router]);\r\n\r\n  const fetchUserData = async () => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch(`${API_BASE_URL}/api/users/me/`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch user data');\r\n      }\r\n\r\n      const userData = await response.json();\r\n      setUser(userData);\r\n      setFormData(userData);\r\n    } catch (err) {\r\n      setError('Failed to load profile data');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({ ...prev, [name]: value }));\r\n    setFormErrors(prev => ({ ...prev, [name]: [] }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      const response = await fetch(`${API_BASE_URL}/api/users/me/`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(formData),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        setFormErrors(errorData);\r\n        throw new Error('Failed to update profile');\r\n      }\r\n\r\n      const updatedUser = await response.json();\r\n      setUser(updatedUser);\r\n      setIsEditing(false);\r\n    } catch (err) {\r\n      setError('Failed to update profile');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-red-500\">{error}</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-3xl mx-auto bg-white rounded-lg shadow-md overflow-hidden\">\r\n        <div className=\"p-8\">\r\n          <div className=\"flex justify-between items-center mb-8\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">Профиль пользователя</h1>\r\n            <button\r\n              onClick={() => setIsEditing(!isEditing)}\r\n              className=\"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors\"\r\n            >\r\n              {isEditing ? 'Отменить' : 'Редактировать'}\r\n            </button>\r\n          </div>\r\n\r\n          {isEditing ? (\r\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n              <div>\r\n                <label htmlFor=\"username\" className=\"block text-sm font-medium text-gray-700\">\r\n                  Имя пользователя\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"username\"\r\n                  name=\"username\"\r\n                  value={formData.username || ''}\r\n                  onChange={handleChange}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                />\r\n                {formErrors.username && (\r\n                  <p className=\"mt-1 text-sm text-red-500\">{formErrors.username[0]}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\r\n                  Email\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  id=\"email\"\r\n                  name=\"email\"\r\n                  value={formData.email || ''}\r\n                  onChange={handleChange}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                />\r\n                {formErrors.email && (\r\n                  <p className=\"mt-1 text-sm text-red-500\">{formErrors.email[0]}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"phone_number\" className=\"block text-sm font-medium text-gray-700\">\r\n                  Номер телефона\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  id=\"phone_number\"\r\n                  name=\"phone_number\"\r\n                  value={formData.phone_number || ''}\r\n                  onChange={handleChange}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                />\r\n                {formErrors.phone_number && (\r\n                  <p className=\"mt-1 text-sm text-red-500\">{formErrors.phone_number[0]}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div>\r\n                <label htmlFor=\"bio\" className=\"block text-sm font-medium text-gray-700\">\r\n                  О себе\r\n                </label>\r\n                <textarea\r\n                  id=\"bio\"\r\n                  name=\"bio\"\r\n                  value={formData.bio || ''}\r\n                  onChange={handleChange}\r\n                  rows={4}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                />\r\n                {formErrors.bio && (\r\n                  <p className=\"mt-1 text-sm text-red-500\">{formErrors.bio[0]}</p>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"flex justify-end\">\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={isLoading}\r\n                  className=\"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors disabled:opacity-50\"\r\n                >\r\n                  {isLoading ? 'Сохранение...' : 'Сохранить изменения'}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          ) : (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center space-x-4\">\r\n                <div className=\"w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center\">\r\n                  {user.avatar ? (\r\n                    <Image\r\n                      src={user.avatar}\r\n                      alt={user.username}\r\n                      width={80}\r\n                      height={80}\r\n                      className=\"rounded-full\"\r\n                    />\r\n                  ) : (\r\n                    <span className=\"text-2xl text-gray-500\">{user.username[0].toUpperCase()}</span>\r\n                  )}\r\n                </div>\r\n                <div>\r\n                  <h2 className=\"text-xl font-semibold\">{user.username}</h2>\r\n                  {user.is_verified && (\r\n                    <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\r\n                      Проверенный пользователь\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2\">\r\n                <div>\r\n                  <h3 className=\"text-sm font-medium text-gray-500\">Email</h3>\r\n                  <p className=\"mt-1\">{user.email}</p>\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"text-sm font-medium text-gray-500\">Телефон</h3>\r\n                  <p className=\"mt-1\">{user.phone_number}</p>\r\n                </div>\r\n                {user.rating !== undefined && (\r\n                  <div>\r\n                    <h3 className=\"text-sm font-medium text-gray-500\">Рейтинг</h3>\r\n                    <p className=\"mt-1\">{user.rating.toFixed(1)} / 5.0</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {user.bio && (\r\n                <div>\r\n                  <h3 className=\"text-sm font-medium text-gray-500\">О себе</h3>\r\n                  <p className=\"mt-1 text-gray-700\">{user.bio}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAwBe,SAAS;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB,CAAC;IACzD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY,CAAC;IAExD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,MAAM;mDAAY;oBAChB,MAAM,QAAQ,aAAa,OAAO,CAAC;oBACnC,IAAI,CAAC,OAAO;wBACV,OAAO,IAAI,CAAC;wBACZ;oBACF;oBACA;gBACF;;YAEA;QACF;gCAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB;QACpB,IAAI;YACF,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,MAAM,WAAW,MAAM,MAAM,GAAG,mHAAA,CAAA,eAAY,CAAC,cAAc,CAAC,EAAE;gBAC5D,SAAS;oBACP,iBAAiB,CAAC,OAAO,EAAE,OAAO;gBACpC;YACF;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,WAAW,MAAM,SAAS,IAAI;YACpC,QAAQ;YACR,YAAY;QACd,EAAE,OAAO,KAAK;YACZ,SAAS;QACX,SAAU;YACR,aAAa;QACf;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,KAAK,EAAE;YAAM,CAAC;QAC/C,cAAc,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,KAAK,EAAE,EAAE;YAAC,CAAC;IAChD;IAEA,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,aAAa;QACb,SAAS;QAET,IAAI;YACF,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,MAAM,WAAW,MAAM,MAAM,GAAG,mHAAA,CAAA,eAAY,CAAC,cAAc,CAAC,EAAE;gBAC5D,QAAQ;gBACR,SAAS;oBACP,iBAAiB,CAAC,OAAO,EAAE,OAAO;oBAClC,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,YAAY,MAAM,SAAS,IAAI;gBACrC,cAAc;gBACd,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,cAAc,MAAM,SAAS,IAAI;YACvC,QAAQ;YACR,aAAa;QACf,EAAE,OAAO,KAAK;YACZ,SAAS;QACX,SAAU;YACR,aAAa;QACf;IACF;IAEA,IAAI,WAAW;QACb,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAgB;;;;;;;;;;;IAGrC;IAEA,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,6LAAC;gCACC,SAAS,IAAM,aAAa,CAAC;gCAC7B,WAAU;0CAET,YAAY,aAAa;;;;;;;;;;;;oBAI7B,0BACC,6LAAC;wBAAK,UAAU;wBAAc,WAAU;;0CACtC,6LAAC;;kDACC,6LAAC;wCAAM,SAAQ;wCAAW,WAAU;kDAA0C;;;;;;kDAG9E,6LAAC;wCACC,MAAK;wCACL,IAAG;wCACH,MAAK;wCACL,OAAO,SAAS,QAAQ,IAAI;wCAC5B,UAAU;wCACV,WAAU;;;;;;oCAEX,WAAW,QAAQ,kBAClB,6LAAC;wCAAE,WAAU;kDAA6B,WAAW,QAAQ,CAAC,EAAE;;;;;;;;;;;;0CAIpE,6LAAC;;kDACC,6LAAC;wCAAM,SAAQ;wCAAQ,WAAU;kDAA0C;;;;;;kDAG3E,6LAAC;wCACC,MAAK;wCACL,IAAG;wCACH,MAAK;wCACL,OAAO,SAAS,KAAK,IAAI;wCACzB,UAAU;wCACV,WAAU;;;;;;oCAEX,WAAW,KAAK,kBACf,6LAAC;wCAAE,WAAU;kDAA6B,WAAW,KAAK,CAAC,EAAE;;;;;;;;;;;;0CAIjE,6LAAC;;kDACC,6LAAC;wCAAM,SAAQ;wCAAe,WAAU;kDAA0C;;;;;;kDAGlF,6LAAC;wCACC,MAAK;wCACL,IAAG;wCACH,MAAK;wCACL,OAAO,SAAS,YAAY,IAAI;wCAChC,UAAU;wCACV,WAAU;;;;;;oCAEX,WAAW,YAAY,kBACtB,6LAAC;wCAAE,WAAU;kDAA6B,WAAW,YAAY,CAAC,EAAE;;;;;;;;;;;;0CAIxE,6LAAC;;kDACC,6LAAC;wCAAM,SAAQ;wCAAM,WAAU;kDAA0C;;;;;;kDAGzE,6LAAC;wCACC,IAAG;wCACH,MAAK;wCACL,OAAO,SAAS,GAAG,IAAI;wCACvB,UAAU;wCACV,MAAM;wCACN,WAAU;;;;;;oCAEX,WAAW,GAAG,kBACb,6LAAC;wCAAE,WAAU;kDAA6B,WAAW,GAAG,CAAC,EAAE;;;;;;;;;;;;0CAI/D,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCACC,MAAK;oCACL,UAAU;oCACV,WAAU;8CAET,YAAY,kBAAkB;;;;;;;;;;;;;;;;6CAKrC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDACZ,KAAK,MAAM,iBACV,6LAAC,gIAAA,CAAA,UAAK;4CACJ,KAAK,KAAK,MAAM;4CAChB,KAAK,KAAK,QAAQ;4CAClB,OAAO;4CACP,QAAQ;4CACR,WAAU;;;;;iEAGZ,6LAAC;4CAAK,WAAU;sDAA0B,KAAK,QAAQ,CAAC,EAAE,CAAC,WAAW;;;;;;;;;;;kDAG1E,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;0DAAyB,KAAK,QAAQ;;;;;;4CACnD,KAAK,WAAW,kBACf,6LAAC;gDAAK,WAAU;0DAAsG;;;;;;;;;;;;;;;;;;0CAO5H,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,6LAAC;gDAAE,WAAU;0DAAQ,KAAK,KAAK;;;;;;;;;;;;kDAEjC,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,6LAAC;gDAAE,WAAU;0DAAQ,KAAK,YAAY;;;;;;;;;;;;oCAEvC,KAAK,MAAM,KAAK,2BACf,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,6LAAC;gDAAE,WAAU;;oDAAQ,KAAK,MAAM,CAAC,OAAO,CAAC;oDAAG;;;;;;;;;;;;;;;;;;;4BAKjD,KAAK,GAAG,kBACP,6LAAC;;kDACC,6LAAC;wCAAG,WAAU;kDAAoC;;;;;;kDAClD,6LAAC;wCAAE,WAAU;kDAAsB,KAAK,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS7D;GA5PwB;;QACP,qIAAA,CAAA,YAAS;;;KADF","debugId":null}}]
}